/*!
 * MQSugr v1.0
 *
 * Copyright (c) 2011-2012 Dave Olsen, http://dmolsen.com
 * Licensed under the MIT license
 */
function MQSugr(a){this.cssPath="css/";this.jsPath="js/";this.mm="min";this.mt="screen";this.lbd="css";if(a){if(a.cssPath){this.cssPath=a.cssPath}if(a.jsPath){this.jsPath=a.jsPath}if(a.mm){this.mm=a.mm}if(a.mt){this.mt=a.mt}if(a.lbd){this.lbd=a.lbd}}this.trackComplete=[];this.trackCallback=[];this.trackLoaded=[];this.startX=window.innerWidth;window.onresize=function(){mqsugr.check(breakpoints)};window.onorientationchange=function(){mqsugr.check(breakpoints)}}MQSugr.prototype.trimStr=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};MQSugr.prototype.mergeOptions=function(d,c){var b={};for(var a in d){b[a]=d[a]}for(var a in c){b[a]=c[a]}return b};MQSugr.prototype.sortByName=function(d,c){return d.filePath.length-c.filePath.length};MQSugr.prototype.sortByType=function(e,d){var f=(e.ft=="css")?2:1;var c=(d.ft=="css")?2:1;return f-c};MQSugr.prototype.inArray=function(d,c){var b=c.length;for(var a=0;a<b;a++){if(c[a]==d){return true}}return false};MQSugr.prototype.clone=function(d){if(null==d||"object"!=typeof d){return d}if(d instanceof Array){var e=[];var c=0;for(var b=d.length;c<b;++c){e[c]=this.clone(d[c])}return e}if(d instanceof Object){var e={};for(var a in d){if(d.hasOwnProperty(a)){e[a]=this.clone(d[a])}}return e}};MQSugr.prototype.clean=function(a){_array=this.clone(a);for(item in _array){types=[{option:"yep",result:true},{option:"nope",result:false},{option:"both",result:true},{option:"both",result:false}];for(type in types){if(_array[item][types[type].option]&&(_array[item].test==types[type].result)){if(!this.inArray(_array[item].filePath,this.trackLoaded)){this.trackLoaded.push(_array[item].filePath)}else{delete _array[item][types[type].option]}}}}return _array};MQSugr.prototype.createYepNopePath=function(g,e,f,b,d){if(g){var c=new RegExp("{"+d+"Path}");var a=g.replace(c,b)}else{a=b+e.replace(/px$/,"")+f+"."+d}return a};MQSugr.prototype.createMTestObject=function(l){var c=l.mq;var f=(l.cssPath)?l.cssPath:this.cssPath;var i=(l.jsPath)?l.jsPath:this.jsPath;var g=(l.ft)?l.ft:"css";var e=(l.mm)?l.mm:this.mm;var b=(l.mt)?l.mt:this.mt;var k=(l.test)?"."+l.test.replace(/\ \|\|\ /,"-").replace(/\ \&\&\ /,"-"):"";var d=(g=="js")?i:f;var j={};j.test=Modernizr.mq("only "+b+" and ("+e+"-width: "+c+")");if(l.test&&(l.test!="")){multiAnd=l.test.split(" && ");multiOr=l.test.split(" || ");if(multiAnd.length!=1){for(and in multiAnd){j.test=j.test&&Modernizr[multiAnd[and]]}}else{if(multiOr.length!=1){for(or in multiOr){j.test=j.test||Modernizr[multiOr[or]]}}else{j.test=j.test&&Modernizr[l.test]}}}if(l.hiRes){j.test=j.test&&Modernizr.mq("only "+b+" and (-webkit-min-device-pixel-ratio: 1.5), only "+b+" and (-o-min-device-pixel-ratio: 3/2), only "+b+" and (min-device-pixel-ratio: 1.5)")}if(l.yep||l.nope||l.mboth){var h=["yep","nope","mboth"];for(ynType in h){var a=(h[ynType]=="mboth")?"both":h[ynType];if(l[h[ynType]]){j[a]=this.createYepNopePath(l[h[ynType]],c,k,d,g);j.filePath=j[a]}}}else{j.yep=this.createYepNopePath(false,c,k,d,g);j.filePath=j.yep}if(l.callback&&Modernizr.mq("only "+b+" and ("+e+"-width: "+c+")")){if(!this.inArray(l.callback.toString(),this.trackCallback)){j.callback=l.callback;this.trackCallback.push(l.callback.toString())}}if(l.complete&&Modernizr.mq("only "+b+" and ("+e+"-width: "+c+")")){if(!this.inArray(l.complete.toString(),this.trackComplete)){j.complete=l.complete;this.trackComplete.push(l.complete.toString())}}j.ft=(l.ft=="js")?"js":"css";return j};MQSugr.prototype.breakUpYepNope=function(e){var d=[];var b=["yep","nope","mboth"];for(ynbType in b){if(e[b[ynbType]]){var a=e[b[ynbType]];var c=this.clone(e);c._lbd="none";for(_ynbType in b){if(b[ynbType].toString()!=b[_ynbType].toString()){if(c[b[_ynbType]]){delete c[b[_ynbType]]}}}if(typeof a=="string"){c.ft=(a.match(/js$/))?"js":"css";d=d.concat(this.breakUpTests(c,c.tests))}else{for(path in a){c[b[ynbType]]=a[path];c.ft=(a[path].match(/js$/))?"js":"css";d=d.concat(this.breakUpTests(c,c.tests))}}c._lbd=""}}return d};MQSugr.prototype.breakUpTests=function(b,a){var e=[];if(!a){a=""}var c=a.split(",");if(c.length!=1){for(test in c){var d=this.clone(b);d.test=this.trimStr(c[test]);e.push(this.createMTestObject(d))}}else{var d=this.clone(b);d.test=a;e.push(this.createMTestObject(d))}return e};MQSugr.prototype.createMTestObjects=function(b,d){var c=[];if(typeof d=="string"){c=c.concat(this.breakUpTests(b,d))}else{for(subOption in d){var a=this.mergeOptions(b,d[subOption]);if(a.yep||a.nope||a.mboth){c=c.concat(this.breakUpYepNope(a))}else{c=c.concat(this.breakUpTests(a,a.tests))}}}return c};MQSugr.prototype.createMLoadObject=function(a){if(typeof a=="string"){var c={};c=this.createMTestObject({mq:a})}else{var b=(a.lbd)?a.lbd:this.lbd;var c=[];if(a.yep||a.nope||a.mboth){c=c.concat(this.breakUpYepNope(a))}else{if(a.css){a.ft="css";c=c.concat(this.createMTestObjects(a,a.css))}if(a.js){a.ft="js";c=c.concat(this.createMTestObjects(a,a.js))}if(a.both){a.ft="css";c=c.concat(this.createMTestObjects(a,a.both));a.ft="js";c=c.concat(this.createMTestObjects(a,a.both))}if(a.tests){if(b=="both"){a.ft="css";c=c.concat(this.createMTestObjects(a,a.tests));a.ft="js";c=c.concat(this.createMTestObjects(a,a.tests))}else{if(b=="css"){a.ft="css";c=c.concat(this.createMTestObjects(a,a.tests))}else{if(b=="none"){}else{a.ft="js";c=c.concat(this.createMTestObjects(a,a.tests))}}}}if(b=="both"){a.ft="css";c.push(this.createMTestObject(a));a.ft="js";c.push(this.createMTestObject(a))}else{if(b=="css"){a.ft="css";c.push(this.createMTestObject(a))}else{if(b=="none"){}else{a.ft="js";c.push(this.createMTestObject(a))}}}}}return c};MQSugr.prototype.check=function(c){var a=window.innerWidth;if(a>=this.startX){this.startX=a;var b=[];for(MQbreakpoint in c){b=b.concat(this.createMLoadObject(c[MQbreakpoint]))}b.sort(this.sortByName);b.sort(this.sortByType);b=this.clean(b);Modernizr.load(b)}};